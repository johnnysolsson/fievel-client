import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="Docs/CI-CD" />

# Fievel Client

A React + TypeScript frontend (Vite) for managing candidate/role **Cards**.

**Design highlights**
- Profile image on the **left**
- **Name + Role** stacked below the image
- **Nyckelord** label with tags on the **right**
- **Actions** ("Ändra", "Pausa") under the tags (right column)
- **No card borders or shadows** — only a thin divider between cards

---

## Tech Stack

- React \& ReactDOM: **19.2.0**
- TypeScript: **5.9.x**
- Vite: **7.x**
- Tailwind CSS: **3.4.x**
- Storybook: **10.1.x**

> Versions reflect your `package.json`.

---

## Getting Started

> Requires **Node.js 20** (the CI uses Node 20).

```bash
# Install deps
npm install              # or: pnpm install / yarn install

# Run dev server
npm run dev              # Vite dev (http://localhost:5173)

# Build (typecheck + Vite build + copy .htaccess)
npm run build

# Preview production build locally
npm run preview          # Vite preview

# Storybook (development)
npm run storybook        # http://localhost:6006

# Storybook (build)
npm run build-storybook  # outputs static site under storybook-static/
```

**Scripts** are defined in `package.json`. The build script runs TypeScript project build, then Vite build, and copies `.htaccess` to `dist`.

---

## Project Structure

```
src/
  App.tsx
  main.tsx
  index.css
  components/
    Card/
      Card.tsx
      Card.stories.tsx
      index.tsx
    CardGrid/
      CardGrid.tsx
      CardsGrid.stories.tsx
      index.tsx
    Modal/
      Modal.tsx
      Modal.stories.tsx
      index.tsx
    ErrorBoundary.tsx
.storybook/
  main.ts
  preview.ts
  vitest.setup.ts
```

*(Structure derived from the uploaded project tree.)*

---

## Cards — Usage Example

```tsx
<Card
  name="Morgan"
  role="UX Designer"
  imageSrc="https://via.placeholder.com/80"
  tags={["UX Designer", "Product Owner", "Product Designer"]}
  onEdit={() => console.log('Edit Morgan')}
  onArchive={() => console.log('Archive Morgan')}
/>
```

**Layout rules**:
- Two-column flex container: `w-32` left column (image, name, role), right column (Nyckelord, tags, actions)
- Buttons live **under** the tags in the **right column**
- Card container: **transparent**; apply `border-b` for the divider only

---

## CI/CD (Deploy to Inleed)

GitHub Actions workflow: `.github/workflows/deploy.yml`

Key points:
- Triggers on `push` to `main` and on manual dispatch when relevant frontend files change
- Node 20; `npm ci` then `npm run build`
- Detects `build/` or `dist/` for outputs (Vite uses `dist/`)
- Uploads artifact, then rsyncs to your Inleed docroot via SSH with `--delete` and sane permissions
- Uploads an `.htaccess` if found (prefers built locations, then repo root, then `public/`)
- Optional health check step placeholder (site URL currently `https://fievel.54u.se`)

See `docs/CI-CD.md` for exact secrets/variables.

---

## License

TBD (add a LICENSE file if applicable).
